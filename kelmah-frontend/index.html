<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Kelma</title>
    <link href="https://fonts.googleapis.com/css2?family=Righteous&display=swap" rel="stylesheet">
    <!-- VERCEL-SPECIFIC REACT FIX -->
    <script>
      (function() {
        'use strict';
        
        console.log('ðŸ”§ Vercel React Fix Loading...');
        
        // Comprehensive React implementation for Vercel
        const createReactImplementation = () => ({
          useState: function(initial) { 
            console.log('âœ… React useState called');
            return [initial, function(newVal) { 
              if (typeof newVal === 'function') return newVal(initial);
              return newVal;
            }]; 
          },
          useEffect: function(effect, deps) { 
            console.log('âœ… React useEffect called');
            if (typeof effect === 'function') {
              try { effect(); } catch(e) { console.warn('useEffect error:', e); }
            }
          },
          useContext: function(context) { 
            console.log('âœ… React useContext called');
            return context ? context.defaultValue : null; 
          },
          useReducer: function(reducer, initial) { 
            console.log('âœ… React useReducer called');
            return [initial, function(action) { 
              try { return reducer(initial, action); } catch(e) { return initial; }
            }]; 
          },
          useCallback: function(fn, deps) { 
            console.log('âœ… React useCallback called');
            return fn; 
          },
          useMemo: function(fn, deps) { 
            console.log('âœ… React useMemo called');
            try { return fn(); } catch(e) { return null; }
          },
          useRef: function(initial) { 
            console.log('âœ… React useRef called');
            return { current: initial }; 
          },
          useImperativeHandle: function() { console.log('âœ… React useImperativeHandle called'); },
          useLayoutEffect: function(effect, deps) {
            console.log('âœ… React useLayoutEffect called');
            if (typeof effect === 'function') {
              try { effect(); } catch(e) { console.warn('useLayoutEffect error:', e); }
            }
          },
          useDebugValue: function() { console.log('âœ… React useDebugValue called'); },
          useSyncExternalStore: function(subscribe, getSnapshot, getServerSnapshot) { 
            console.log('âœ… React useSyncExternalStore called');
            try {
              return getSnapshot ? getSnapshot() : (getServerSnapshot ? getServerSnapshot() : null);
            } catch(e) { 
              console.warn('useSyncExternalStore error:', e);
              return null; 
            }
          },
          createElement: function(type, props, ...children) { 
            return { type, props: props || {}, children };
          },
          Fragment: function(props) { return props.children; },
          Component: function() {},
          PureComponent: function() {},
          memo: function(component) { return component; },
          forwardRef: function(render) { return render; },
          createContext: function(defaultValue) { 
            return { 
              Provider: function(props) { return props.children; },
              Consumer: function(props) { return props.children(defaultValue); },
              defaultValue: defaultValue
            };
          },
          lazy: function(fn) { return fn; },
          Suspense: function(props) { return props.children; },
          version: '18.3.1-vercel-patched'
        });

        const ReactImpl = createReactImplementation();

        // Set React in ALL possible global locations
        if (typeof window !== 'undefined') {
          window.React = ReactImpl;
          // Also set common React access patterns
          window.r = ReactImpl;  // For {r as Y} imports
          window.R = ReactImpl;  // For {R as ...} imports
        }
        
        if (typeof globalThis !== 'undefined') {
          globalThis.React = ReactImpl;
          globalThis.r = ReactImpl;
          globalThis.R = ReactImpl;
        }
        
        if (typeof global !== 'undefined') {
          global.React = ReactImpl;
          global.r = ReactImpl;
          global.R = ReactImpl;
        }

        // Override Object.defineProperty to catch React assignments
        const originalDefineProperty = Object.defineProperty;
        Object.defineProperty = function(obj, prop, descriptor) {
          if (prop === 'React' || prop === 'r' || prop === 'R') {
            console.log(`ðŸ”§ Intercepted ${prop} assignment, ensuring React is available`);
            if (!descriptor.value || typeof descriptor.value !== 'object') {
              descriptor.value = ReactImpl;
            }
          }
          return originalDefineProperty.call(this, obj, prop, descriptor);
        };

        // Persistent React monitoring - aggressive approach for Vercel
        let checkCount = 0;
        const persistentCheck = setInterval(() => {
          checkCount++;
          let needsReset = false;

          if (!window.React || typeof window.React.useState !== 'function') {
            window.React = ReactImpl;
            needsReset = true;
          }
          if (!window.r || typeof window.r.useState !== 'function') {
            window.r = ReactImpl;
            needsReset = true;
          }
          if (!globalThis.React || typeof globalThis.React.useState !== 'function') {
            globalThis.React = ReactImpl;
            needsReset = true;
          }

          if (needsReset) {
            console.warn(`ðŸ”§ Reset React at check ${checkCount}`);
          }

          // Stop checking after 50 attempts (5 seconds)
          if (checkCount >= 50) {
            clearInterval(persistentCheck);
            console.log('ðŸ”§ Persistent React check completed');
          }
        }, 100);

        console.log('âœ… Vercel React fix loaded with persistent monitoring');
        console.log('React.useState available:', typeof ReactImpl.useState);
      })();
    </script>
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.jsx"></script>
  </body>
</html>
